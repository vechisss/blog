---
# è¿™æ˜¯æ–‡ç« çš„æ ‡é¢˜
title: æœ¬åœ°ç¯å¢ƒå¼€å¯HTTPS (wamp64) å›é¡¾
# ä½ å¯ä»¥è‡ªå®šä¹‰å°é¢å›¾ç‰‡
# cover: /assets/images/cover1.jpg
# è¿™æ˜¯é¡µé¢çš„å›¾æ ‡
# icon: file
# è¿™æ˜¯ä¾§è¾¹æ çš„é¡ºåº
order: 1
# è®¾ç½®ä½œè€…
# author: Ms.Hope
# è®¾ç½®å†™ä½œæ—¶é—´
date: 2024-08-01
# ä¸€ä¸ªé¡µé¢å¯ä»¥æœ‰å¤šä¸ªåˆ†ç±»
# category:
  # - ä½¿ç”¨æŒ‡å—
# ä¸€ä¸ªé¡µé¢å¯ä»¥æœ‰å¤šä¸ªæ ‡ç­¾
tag:
  - é…ç½®é—®é¢˜
  # - ä½¿ç”¨æŒ‡å—
# æ­¤é¡µé¢ä¼šåœ¨æ–‡ç« åˆ—è¡¨ç½®é¡¶
# sticky: true
# æ­¤é¡µé¢ä¼šå‡ºç°åœ¨æ˜Ÿæ ‡æ–‡ç« ä¸­
# star: true
# ä½ å¯ä»¥è‡ªå®šä¹‰é¡µè„š
# footer: è¿™æ˜¯æµ‹è¯•æ˜¾ç¤ºçš„é¡µè„š
# ä½ å¯ä»¥è‡ªå®šä¹‰ç‰ˆæƒä¿¡æ¯
# copyright: 123

contributors: false
editLink: false
---
<!-- more -->

# å‰è¨€ï¼š

`è¸©å‘äº†ä¸¤å¤©ï¼ ä¸»è¦é—®é¢˜åœ¨äºhttpd-ssl.conf.`

å®é™…éœ€æ±‚ä¸ºï¼šæ­£å¼ç¯å¢ƒéœ€å¼€å¯Httpsè®¿é—®ï¼Œæ•…å°†æœ¬åœ°ç¯å¢ƒ Wamp 64( Apache + MySQL + PHP74 + Windows)  ç¯å¢ƒåŒæ­¥ wss:// å’Œæµ‹è¯•å…¶ä»–é€»è¾‘ä»£ç ã€‚
#### è‡ªç­¾è¯ä¹¦å·¥å…·
 `éœ€ä¸‹è½½å¯¹åº”wampç‰ˆæœ¬çš„OpenSSLè¯ä¹¦ç‰ˆæœ¬`
 ä¸‹è½½åœ°å€:  [openssl](https://slproweb.com/products/Win32OpenSSL.html)
 é€‰æ‹© Light ç‰ˆæœ¬ / å¯¹åº”æ“ä½œç³»ç»Ÿå³å¯
 å®‰è£…å®Œæ¯•ç›®å½•ï¼šC:\Program Files\OpenSSL-Win64\bin ï¼ˆåç»­ä»¥æ­¤ä¸ºä¾‹ï¼‰
___
#### åˆ›å»ºå¿…è¦è¯ä¹¦
`ç”Ÿæˆæ— å¯†ç ç‰ˆæœ¬`

 1. è¿›å…¥OpenSSL binç›®å½•

```csharp
cd C:\Program Files\OpenSSL-Win64\bin
```
 2. åˆ›å»ºè¯ä¹¦
		æ­¤æ—¶binç›®å½•æ–°å¢ server.key æ–‡ä»¶ã€‚
```csharp
openssl genrsa -des3 -out server.key 2048
```
```csharp
openssl rsa -in server.key -out server.key
```
3. è¿›å…¥Apacheçš„Confç›®å½•ï¼Œæ–°å¢æ–‡ä»¶ï¼š openssl.cnf
`æ­¤é¡¹å¾ˆå¤šæ•™ç¨‹æ²¡æåŠ`
ä»¥æ­¤ç›®å½•ä¸ºæ¡ˆä¾‹ï¼šC:\wamp64\bin\apache\apache2.4.46\conf ï¼Œæ–°å»º openssl.cnf æ–‡ä»¶
`åŸŸåè¯·æ›¿æ¢æˆä½ è‡ªå·±æµ‹è¯•ç¯å¢ƒè¦ç”¨çš„, å¦åˆ™å°†å¯¼è‡´å¯èƒ½æ— æ³•ç”Ÿæ•ˆï¼Œå…¶ä»–æ— æ‰€è°“`
```csharp
[ req ]
default_bits        = 2048
default_md          = sha256
distinguished_name  = req_distinguished_name
x509_extensions     = v3_req
prompt              = no

[ req_distinguished_name ]
C            = CN                  # å›½å®¶ä»£ç  (ä¸­å›½ä¸ºCN)
ST           = State               # çœ/å·
L            = City                # åŸå¸‚
O            = Organization        # ç»„ç»‡åç§°
OU           = Organizational Unit # ç»„ç»‡å•ä½åç§°
CN           = www.åŸŸå.com        # é€šç”¨åç§° (ä¾‹å¦‚ï¼ŒåŸŸå)

[ v3_req ]
subjectAltName = @alt_names
basicConstraints = CA:FALSE
keyUsage = nonRepudiation, digitalSignature, keyEncipherment

[ alt_names ]
DNS.1   = www.åŸŸå.com
DNS.2   = åŸŸå.com

```
4. ç”Ÿæˆæ— å¯†ç ç‰ˆæœ¬
`å¼•å…¥å‰é¢æ–°å»ºçš„ openssl.cnf æ–‡ä»¶`

```csharp
openssl req -new -x509 -key server.key -out ca.crt -days 3650 -config C:\wamp64\bin\apache\apache2.4.46\conf\openssl.cnf
```
5. ç”Ÿæˆserver.csræ–‡ä»¶

```csharp
openssl req -new -key server.key -out server.csr -config C:\wamp64\bin\apache\apache2.4.46\conf\openssl.cnf
```
6. ç”Ÿæˆserver.csræ–‡ä»¶

```csharp
openssl x509 -req -days 3650 -in server.csr -CA ca.crt -CAkey server.key -CAcreateserial -out server.crt
```
7. ç§»åŠ¨è¯ä¹¦è‡³æŒ‡å®šç›®å½•
	server.crt
	server.key 
	å‰ªåˆ‡åˆ°C:\wamp64\bin\apache\apache2.4.46\conf ä½ç½®,
	æ˜¯çš„ï¼Œåªéœ€è¦ä¸¤ä¸ªã€‚
___

#### é…ç½®ï¼šhttpd.conf

ç¼–è¾‘ï¼š C:\wamp64\bin\apache\apache2.4.51\conf\httpd.conf æ–‡ä»¶
å‰é¢çš„#å·åˆ é™¤
```csharp
	Include conf/extra/httpd-ssl.conf 
	LoadModule ssl_module modules/mod_ssl.so
	LoadModule socache_shmcb_module modules/mod_socache_shmcb.so
```

---
#### é…ç½®ï¼šhttpd-ssl.conf
`è¿™é‡Œæ˜¯è¸©å‘æœ€å¤šçš„åœ°æ–¹`
ä¸€éä¸€éé…ç½®äº†ï¼Œä»¥ä¸ºæ˜¯è·¯å¾„å¼•å…¥é—®é¢˜ï¼Œä»¥ä¸ºhosté—®é¢˜ç­‰ç­‰ï¼Œäºæ˜¯æˆ‘åˆ¨äº†è¾¹æºç ï¼Œæ‰¾åˆ°é—®é¢˜å‡ºåœ¨ **Listen 443** è¿™ä¸ªé¦–è¡Œä¹Ÿæ˜¯æœ€å®¹æ˜“å¿½ç•¥çš„ï¼
å…ˆè¯´ä¸€èˆ¬é…ç½®è¿‡ç¨‹ï¼šåŒæ ·çš„ é…ç½®é¡¹ - æ›¿æ¢ä½ çš„ä¸œä¸œ
```csharp
DocumentRoot "${INSTALL_DIR}/www"
ServerName www.ä½ çš„åŸŸå.com:443
SSLCertificateKeyFile "C:\wamp64\bin\apache\apache2.4.46\conf\server.key"
SSLCertificateFile "C:\wamp64\bin\apache\apache2.4.46\conf\server.crt"
```
æ˜¯çš„ï¼Œåªæœ‰4ä¸ªåœ°æ–¹ã€‚
ä½†å§‹ç»ˆæˆ‘ä¸€ç›´é‡å¯WampæœåŠ¡éƒ½åˆ°é»„è‰²è­¦å‘ŠçŠ¶æ€ï¼Œç»™æˆ‘éƒ½çœ‹éº»äº†ã€‚
è§£å†³æ€è·¯ï¼š
  ç¡®ä¿è™šæ‹Ÿä¸»æœºé…ç½®æ­£ç¡®ï¼Œå¯ä»¥å°è¯•å°†é…ç½®æ–‡ä»¶ä¸­å¤šä½™çš„éƒ¨åˆ†æ³¨é‡Šæ‰ï¼Œæœ€å°åŒ–é…ç½®ä»¥æ’é™¤é—®é¢˜ã€‚ä¾‹å¦‚**æ¸…ç©º**httpd-ssl.conf æ–‡ä»¶ï¼Œåªä¿ç•™ï¼š
  
```c
<VirtualHost *:443>
    DocumentRoot "ç½‘ç«™ç›®å½•"
    ServerName www.ä½ çš„åŸŸå.com
    SSLEngine on
	SSLCertificateKeyFile "C:\wamp64\bin\apache\apache2.4.46\conf\server.key"
	SSLCertificateFile "C:\wamp64\bin\apache\apache2.4.46\conf\server.crt"
</VirtualHost>
```
æ’æŸ¥ç€ä¸å¯¹åŠ²ï¼Œåˆ°æœ€åç¡®å®šå°±æ˜¯ httpd-ssl.conf æ–‡ä»¶çš„é—®é¢˜ï¼Œæˆ‘ä¸€è¡Œä¸€è¡Œåˆ é™¤ï¼Œçœ‹åˆ°åº•å“ªé‡Œå½±å“äº†ï¼Œå°±æ˜¯ç¬¬ä¸€è¡Œæˆ‘æœ€ä¿¡ä½ äº†ã€‚ã€‚ã€‚ ä¸æ˜¾çœ¼çš„ **Listen 443** 

##### ç«¯å£å†²çª
æ˜¯æˆ‘çš„å…¶ä»–æœåŠ¡å ç”¨ç«¯å£

Windowså‘½ä»¤ï¼šnetstat -aon | findstr :443
æŸ¥å‡ºï¼š  TCP    [::]:443               [::]:0                 LISTENING       7060

**ä»netstatçš„ç»“æœæ¥çœ‹ï¼Œç«¯å£443å·²ç»è¢«è¿›ç¨‹IDä¸º7060çš„è¿›ç¨‹å ç”¨äº†ã€‚è¿™æ„å‘³ç€ç›®å‰æœ‰ä¸€ä¸ªæœåŠ¡æ­£åœ¨ç›‘å¬443ç«¯å£ï¼Œè¿™å¯èƒ½æ˜¯å¯¼è‡´Apacheæ— æ³•å¯åŠ¨çš„åŸå› ã€‚**

å†æŸ¥ï¼š tasklist /FI "PID eq 7060"
æŸ¥å‡ºï¼š vmware-hostd.exe              7060 Services                   0     55,504 K

**ç«¯å£443æ˜¯ç”±vmware-hostd.exeè¿›ç¨‹å ç”¨çš„ã€‚vmware-hostd.exeæ˜¯VMware Workstationæˆ–å…¶ä»–VMwareäº§å“çš„ç›¸å…³è¿›ç¨‹ï¼Œç”¨äºç®¡ç†è™šæ‹Ÿæœºå’Œç½‘ç»œæœåŠ¡ã€‚è¿™æ˜¯å¯¼è‡´Apacheæ— æ³•ç›‘å¬443ç«¯å£çš„åŸå› ã€‚**

åœæ­¢ï¼š net stop "VMware Host Agent"

wamp å®ƒç»ˆäºç»¿äº† ğŸ˜­

---

#### é…ç½®ï¼šVirtual Host

å…ˆåœ¨æœ¬åœ°hostæ–‡ä»¶å†…æ–°å¢ä½ çš„åŸŸåï¼š C:\Windows\System32\drivers\etc\hosts
å†åœ¨ C:\wamp64\bin\apache\apache2.4.51\conf\extra\httpd-vhosts.conf ç¼–è¾‘ä½ çš„è™šæ‹Ÿç«¯å£

```c
<VirtualHost *:443>
  ServerName www.ä½ çš„åŸŸå.com
  ServerAlias www.ä½ çš„åŸŸå.com
  DocumentRoot "ä½ çš„ç½‘ç«™ç›®å½•"
	SSLEngine on
	SSLCertificateKeyFile "C:\wamp64\bin\apache\apache2.4.46\conf\server.key"
	SSLCertificateFile "C:\wamp64\bin\apache\apache2.4.46\conf\server.crt"
  <Directory "ä½ çš„ç½‘ç«™ç›®å½•">
    Options +Indexes +Includes +FollowSymLinks +MultiViews
    AllowOverride All
    Require local
	Require all granted
  </Directory>
</VirtualHost>
```

---

end